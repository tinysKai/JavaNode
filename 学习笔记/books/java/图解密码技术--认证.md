## 图解密码技术--认证

### 单向散列函数

单向散列函数( one-way hash function)有一个输人和一个输出，其中输人称为消息( message ),输出称为散列值( hash value)。单向散列函数可以根据消息的内容计算出散列值，而散列值就可以被用来检查消息的完整性。单向散列函数也被成为消息摘要函数.

#### 单向散列函数的性质

+ 输入可以是任意长度的消息
+ 效率高
+ 具有抗碰撞性
+ 单向性,无法从散列值逆推消息
+ 相同的散列函数生成的签名的长度值固定

#### 常见的单向散列

+ MD5 - 128bit的散列值
+ SHA-1
+ SHA-2
  + SHA-256
  + SHA-384
  + SHA-512
+ SHA-3		

### 消息认证码

消息认证码( Message Authentication Code )是一种确认完整性并进行认证的技术，取三个单词的首字母，简称为MAC。消息认证码的输人包括任意长度的消息和一个发送者与接收者之间**共享**的密钥，它可以输出固定长度的数据，这个数据称为MAC值。消息认证码是一种与密钥相关联的单向散列函数.

使用消息认证码可以确认自己收到的消息是否就是发送者的本意，也就是说，使用消息认证码可以判断消息是否被篡改，以及是否有人伪装成发送者发送了该消息。

#### 对消息认证码的攻击

重放攻击的常见防御手段

+ 使用递增的序号 - 通信双方都需保存最后一个count值,保证每一次的通信的count值都不应小于上一次的值
+ 时间戳 - 使用当前时间戳来做校验,需考虑到通信延迟,机器时钟等,所以需在通信双方预留一定的时间buffer,因此还是存在一定的风险性
+ nonce - 每次真正通信前增加一次通信来传递盐,会导致增加通信量

#### 消息认证码无法解决的问题

+ 对第三方证明
+ 防止否认

### 数字签名

数字签名可以识别篡改和伪装,还可以防止否认.在数字签名技术中包括以下两种行为 : 生成消息签名的行为以及验证消息签名的行为.在数字签名中，生成签名和验证签名这两个行为需要使用各自专用的密钥来完成。

非对称密码的用公钥加密所得到的密文，只能用与该公钥配对的私钥才能解密;同样地，用私钥加密所
得到的密文，也只能用与该私钥配对的公钥才能解密。也就是说，如果用某个公钥成功解密了
密文，那么就能够证明这段密文是用与该公钥配对的私钥进行加密所得到的。

#### 非对称密钥加解密与数字签名的区别

![QQ截图20191126211536.png](http://ww1.sinaimg.cn/large/8bb38904ly1g9br54jzl5j20zu0j4adt.jpg)

![QQ截图20191126211544.png](http://ww1.sinaimg.cn/large/8bb38904ly1g9br5geozqj20zl0jmwi6.jpg)

#### 数字签名的方法

+ 直接对消息签名
+ 对消息的散列值签名(现实中一般用这种,因为直接使用非对称加密本身性能就慢,而如果消息体大的话性能会更慢,所以使用散列值将缩短加密的时间)

#### 数字签名的作用

+ 确认消息的完整性
+ 进行认证
+ 防止否认

#### 数字签名应用

+ 公钥证书(验证公钥的合法性,对公钥进行数字签名)
+ SSL/TLS(认证服务器身份是否合法)

#### 数字签名的攻击

+ 中间人攻击

#### 认证码与数学签名对比

![QQ截图20191130211601.png](http://ww1.sinaimg.cn/large/8bb38904ly1g9gdmp4c2mj21cj0md17b.jpg)

### 证书

证书是公钥与数字签名的结合.数字签名是由第三方权威机构CA来对公钥进行数字签名,而验证公钥者则拿着CA的公钥来对证书中的公钥进行解密并与证书中的数字签名进行对比.若一致,则证书则是有效没被替换的

#### 针对证书的攻击方式

+ 攻击者伪装成认证机构(所以需要注意不要随便安装非安全的操作系统)
+ 利用证书失效的时间差进行攻击,攻击者可以盗窃私钥拥有者的私钥后进行发送消息比如转账并进行数字签名,而在CA进行通知以及公钥持有者接收到失效通知之前,攻击者的攻击都是有效的